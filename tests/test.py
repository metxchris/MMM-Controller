import numpy as np # 3rd Party Packages
import matplotlib.pyplot as plt
import scipy.ndimage

def movingaverage_test():
    window_width = 3
    VPOL = [-499.268,-499.268,-1160.13,-1906.77,-2639.36,-3271.14,-3839.17,-4327.92,-4721.99,-5020.67,-5235.96,-5377.69,-5451.62,-5465.43,-5424.32,-5330.84,-5188.84,-5004.10,-4780.58,-4519.62,-4230.65,-3927.62,-3599.96,-3244.53,-2899.74,-2584.62,-2283.50,-1992.06,-1723.03,-1486.91,-1282.03,-1098.73,-937.240,-815.939,-743.808,-712.363,-713.436,-740.849,-788.835,-856.872,-948.787,-1054.12,-1142.63,-1195.56,-1220.26,-1239.22,-1362.68,-1724.38,-2195.38,-2018.60,-1446.27]
    cumsum_vec = np.cumsum(np.insert(VPOL, 0, 0)) 
    VPOL_smoothed = (cumsum_vec[window_width:] - cumsum_vec[:-window_width]) / window_width
    x = range(len(VPOL))
    x2 = range(1, VPOL_smoothed.size + 1)
    plt.figure()
    plt.plot(x, VPOL, x2, VPOL_smoothed)
    plt.show()

def smoothing_test():
    VPOL = [-499.268,-499.268,-1160.13,-1906.77,-2639.36,-3271.14,-3839.17,-4327.92,-4721.99,-5020.67,-5235.96,-5377.69,-5451.62,-5465.43,-5424.32,-5330.84,-5188.84,-5004.10,-4780.58,-4519.62,-4230.65,-3927.62,-3599.96,-3244.53,-2899.74,-2584.62,-2283.50,-1992.06,-1723.03,-1486.91,-1282.03,-1098.73,-937.240,-815.939,-743.808,-712.363,-713.436,-740.849,-788.835,-856.872,-948.787,-1054.12,-1142.63,-1195.56,-1220.26,-1239.22,-1362.68,-1724.38,-2195.38,-2018.60,-1446.27]
    x = range(len(VPOL))
    fig, ax = plt.subplots()
    ax.plot(x, VPOL, 'b')
    ax.plot(x, scipy.ndimage.gaussian_filter(VPOL, 1), 'r')
    plt.show()

def plot_gradient():
    gTE = [0,0.893,0.976,1.091,1.276,1.470,1.694,1.921,2.149,2.374,2.593,2.803,3.007,3.205,3.399,3.587,3.770,3.947,4.117,4.282,4.442,4.596,4.748,4.897,5.045,5.189,5.326,5.460,5.587,5.712,5.826,5.932,6.034,6.122,6.211,6.304,6.422,6.623,6.998,7.696,8.962,11.07,14.39,19.24,26.31,36.71,49.82,64.98,86.95,100,100]
    x = range(len(gTE))
    fig, ax = plt.subplots()
    ax.plot(x, gTE, 'b')
    ax.plot(x, scipy.ndimage.gaussian_filter(gTE, 1), 'r')
    plt.show()

if __name__ == '__main__':
    plot_gradient()
